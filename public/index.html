<!doctype html>
<html>
  <head>
    <title>Socket.IO chat</title>
    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
  </head>

  <body>
    <canvas id="myCanvas">
    </canvas>
  <script>
  var socket = io();
  var canvas= document.getElementById('myCanvas');
  var ctx= canvas.getContext('2d');
  ctx.canvas.width=window.innerWidth;
  ctx.canvas.height=window.innerHeight;
  var width=13;
  var height=20;
  var cursorPic= new Image();
  var myId;
  var angle=0;
  cursorPic.src='img/cursorimg.png';

  jQuery(document).ready(function() {
    var currentDeg=0;
    // Get the proper CSS prefix
  
  document.body.style.cursor("-transform","rotate(" + (currentDeg+50) + "deg)");
  });


  function render(allLocations, allBullets){
    ctx.fillStyle="#000";
    ctx.fillRect(0,0, ctx.canvas.width, ctx.canvas.height);
    ctx.fillStyle= "#FFF";

    for(var location in allLocations){
      if(location!==myId){
      console.log(location.x +" "+ location.y);
      ctx.drawImage(cursorPic, allLocations[location].x, allLocations[location].y, width, height);
      }
    }
    for (var bullet in allBullets){
      ctx.fillStyle="#FF0000";
      ctx.fillRect(allBullets[bullet].x, allBullets[bullet].y, 4, 8);
    }
  }

  $(document).click(function(event){
    socket.emit('fire', x, y, angle);
  })
  $(document).mousemove(function(event) {
    x=event.clientX;
    y=event.clientY;
    socket.emit('coords', x, y);
  });
  socket.on('update', function(allLocations, allBullets){
    render(allLocations, allBullets);

  })
  socket.on('init', function(id){
    myId=id;
  });
  </script>

  </body>
</html>